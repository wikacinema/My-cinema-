<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Wika Cinema Ultimate</title>
    <link rel="manifest" href="/My-cinema-/manifest.json">
    <style>
        :root { --primary: #e50914; --bg: #0b0b0b; --card-bg: #1a1a1a; --text: #ffffff; }
        body { background-color: var(--bg); color: var(--text); font-family: 'Segoe UI', Tahoma, sans-serif; margin: 0; padding: 0; overflow-x: hidden; width: 100vw; }
        
        header { background: rgba(0,0,0,0.95); padding: 10px 3%; display: flex; flex-direction: column; align-items: center; gap: 8px; border-bottom: 2px solid var(--primary); position: sticky; top: 0; z-index: 1000; }
        .logo { color: var(--primary); font-size: 20px; font-weight: 900; cursor: pointer; }
        .nav-tabs { display: flex; justify-content: center; gap: 4px; width: 100%; overflow-x: auto; scrollbar-width: none; }
        .tab-btn { background: #222; border: none; color: white; padding: 6px 10px; border-radius: 15px; cursor: pointer; font-size: 11px; white-space: nowrap; font-weight: 600; }
        .tab-btn.active { background: var(--primary); }
        #search-input { padding: 8px 15px; border-radius: 20px; border: 1px solid #333; width: 90%; max-width: 350px; background: #1a1a1a; color: white; outline: none; text-align: center; font-size: 12px; }

        /* Ø²Ø± Ø§Ù„ØªØ«Ø¨ÙŠØª */
        #installBtn { display: none; background: #2ecc71; color: white; border: none; padding: 5px 15px; border-radius: 20px; font-size: 11px; font-weight: bold; margin-bottom: 5px; cursor: pointer; }

        .hero-slider { width: 100%; height: 220px; position: relative; overflow: hidden; background: #000; display: none; touch-action: pan-y; }
        .hero-slide { position: absolute; inset: 0; display: flex; align-items: flex-end; padding: 25px 5%; background-size: cover; background-position: center; transition: 0.6s ease-in-out; opacity: 0; cursor: pointer; width: 100%; }
        .hero-slide.active { opacity: 1; transform: translateX(0); }
        .hero-slide::after { content: ''; position: absolute; inset: 0; background: linear-gradient(0deg, #0b0b0b 20%, transparent 100%); }
        .hero-title { position: relative; z-index: 2; font-size: 18px; font-weight: bold; text-shadow: 2px 2px 5px #000; pointer-events: none; }

        .filter-section { background: #000; padding: 5px 0; border-bottom: 1px solid #222; width: 100%; }
        .filter-bar { display: flex; gap: 8px; overflow-x: auto; padding: 0 5% 8px 5%; scrollbar-width: none; }
        .filter-btn { background: #1a1a1a; color: #ccc; border: 1px solid #333; padding: 5px 12px; border-radius: 10px; cursor: pointer; white-space: nowrap; font-size: 10px; }
        .filter-btn.active { color: var(--primary); border-color: var(--primary); }

        .movie-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(130px, 1fr)); gap: 12px; padding: 10px 5%; width: 90%; margin: 0 auto; }
        .movie-card { background: var(--card-bg); border-radius: 10px; overflow: hidden; cursor: pointer; border: 1px solid #222; position: relative; }
        .movie-card img { width: 100%; height: 190px; object-fit: cover; display: block; }
        .movie-info { padding: 8px; text-align: center; font-size: 11px; font-weight: 600; height: 30px; overflow: hidden; }
        
        .badge { position: absolute; top: 6px; right: 6px; background: var(--primary); color: white; font-size: 9px; padding: 2px 5px; border-radius: 4px; font-weight: bold; z-index: 2; }
        .fav-icon { position: absolute; top: 6px; left: 6px; background: rgba(0,0,0,0.4); color: rgba(255,255,255,0.8); border: 1px solid rgba(255,255,255,0.5); padding: 5px; border-radius: 50%; font-size: 14px; z-index: 5; transition: 0.3s; }
        .fav-icon.active { color: #ff0000; border-color: #ff0000; background: rgba(0,0,0,0.7); }

        #details-page, #player-page { display: none; position: fixed; inset: 0; background: var(--bg); z-index: 10000; overflow-y: auto; }
        .close-btn { position: fixed; top: 15px; left: 15px; background: var(--primary); color: white; border: none; width: 35px; height: 35px; border-radius: 50%; cursor: pointer; z-index: 10001; }
        
        .meta-info { display: flex; gap: 10px; justify-content: center; margin: 10px 0; color: #aaa; font-size: 12px; }
        .description { padding: 0 10%; line-height: 1.6; color: #ccc; font-size: 14px; text-align: center; }

        .episodes-container { padding: 15px 5%; background: #000; border-top: 1px solid #333; }
        .season-selector { display: flex; gap: 8px; overflow-x: auto; padding-bottom: 10px; scrollbar-width: none; }
        .episode-list { display: grid; grid-template-columns: repeat(auto-fill, minmax(80px, 1fr)); gap: 8px; }
        .ep-btn { background: #1a1a1a; border: 1px solid #333; color: white; padding: 10px; border-radius: 5px; text-align: center; cursor: pointer; font-size: 12px; }
        .ep-btn.active { background: var(--primary); }

        iframe, video { width: 100%; aspect-ratio: 16/9; border: none; background: #000; }
        .btn-action { background: var(--primary); color: white; border: none; padding: 12px 30px; border-radius: 25px; cursor: pointer; font-weight: bold; }

        @media (max-width: 600px) { .movie-grid { grid-template-columns: repeat(2, 1fr); } }
    </style>
</head>
<body>

<header>
    <div class="logo" onclick="location.reload()">WIKA CINEMA PRO</div>
    <button id="installBtn">ØªØ«Ø¨ÙŠØª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ ğŸ“²</button>
    <div class="nav-tabs">
        <button class="tab-btn active" id="tab-movies" onclick="switchMainTab('movies')">ğŸ¬ Ø£ÙÙ„Ø§Ù…</button>
        <button class="tab-btn" id="tab-tvshows" onclick="switchMainTab('tvshows')">ğŸï¸ Ù…Ø³Ù„Ø³Ù„Ø§Øª</button>
        <button class="tab-btn" id="tab-tv" onclick="switchMainTab('tv')">ğŸ“º ØªÙ„ÙØ²ÙŠÙˆÙ†</button>
        <button class="tab-btn" id="tab-fav" onclick="showFavorites()">â¤ï¸ Ø§Ù„Ù…ÙØ¶Ù„Ø©</button>
    </div>
    <input type="text" id="search-input" placeholder="Ø§Ø¨Ø­Ø«...">
</header>

<div id="section-content">
    <div class="hero-slider" id="hero-slider" ontouchstart="handleTouchStart(event)" ontouchend="handleTouchEnd(event)"></div>
    <div class="filter-section" id="filter-area">
        <div class="filter-bar" id="genres-bar"></div>
        <div class="filter-bar" id="langs-bar"></div>
    </div>
    <div class="movie-grid" id="main-grid"></div>
    <button id="load-more-btn" class="btn-action" style="display:block; margin:20px auto;" onclick="loadMore()">Ø§Ù„Ù…Ø²ÙŠØ¯</button>
</div>

<div id="section-tv" style="display:none;">
    <div class="filter-section">
        <div class="filter-bar">
            <button class="filter-btn active" onclick="filterTV('all', this)">Ø§Ù„ÙƒÙ„</button>
            <button class="filter-btn" onclick="filterTV('Sports', this)">Ø±ÙŠØ§Ø¶Ø©</button>
            <button class="filter-btn" onclick="filterTV('News', this)">Ø£Ø®Ø¨Ø§Ø±</button>
            <button class="filter-btn" onclick="filterTV('Kids', this)">Ø£Ø·ÙØ§Ù„</button>
            <button class="filter-btn" onclick="filterTV('Movies', this)">Ø£ÙÙ„Ø§Ù…</button>
            <button class="filter-btn" onclick="filterTV('Religious', this)">Ø¥Ø³Ù„Ø§Ù…ÙŠ</button>
        </div>
    </div>
    <div class="movie-grid" id="tv-grid"></div>
</div>

<div id="details-page"><button class="close-btn" onclick="handleBack()">âœ•</button><div id="details-content"></div></div>
<div id="player-page">
    <button class="close-btn" onclick="handleBack()">âœ•</button>
    <div id="video-frame"></div>
    <div id="episodes-area" class="episodes-container" style="display:none;">
        <h3 id="series-title" style="margin:0 0 10px 0; color:var(--primary); font-size:16px;">Ø§Ù„Ø­Ù„Ù‚Ø§Øª</h3>
        <div class="season-selector" id="season-bar"></div>
        <div class="episode-list" id="episode-bar"></div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
<script>
    const API_KEY = '243d3178406656f0f1ceb1fde181815e'; 
    const IMG = 'https://image.tmdb.org/t/p/w500';
    const BG_IMG = 'https://image.tmdb.org/t/p/original';
    let page = 1, currentMode = 'movies', favSubMode = 'movies', currentGenre = '', currentLang = '', searchQuery = '', tvChannels = [];
    let favorites = JSON.parse(localStorage.getItem('wika_favs')) || [];
    let slideIdx = 0, touchStartX = 0;

    const genresList = [{id:'',n:'Ø§Ù„ÙƒÙ„'},{id:'28',n:'Ø£ÙƒØ´Ù†'},{id:'35',n:'ÙƒÙˆÙ…ÙŠØ¯ÙŠ'},{id:'18',n:'Ø¯Ø±Ø§Ù…Ø§'},{id:'10751',n:'Ø¹Ø§Ø¦Ù„ÙŠ'},{id:'27',n:'Ø±Ø¹Ø¨'},{id:'878',n:'Ø®ÙŠØ§Ù„ Ø¹Ù„Ù…ÙŠ'},{id:'10749',n:'Ø±ÙˆÙ…Ø§Ù†Ø³ÙŠ'},{id:'16',n:'Ø£Ù†ÙŠÙ…ÙŠØ´Ù†'},{id:'14',n:'Ø®ÙŠØ§Ù„ÙŠ'},{id:'99',n:'ÙˆØ«Ø§Ø¦Ù‚ÙŠ'},{id:'36',n:'Ø³ÙŠØ±Ø©'}];
    const langsList = [{id:'',n:'Ø§Ù„ÙƒÙ„'},{id:'ar',n:'Ø¹Ø±Ø¨ÙŠ'},{id:'en',n:'Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠ'},{id:'tr',n:'ØªØ±ÙƒÙŠ'},{id:'ko',n:'ÙƒÙˆØ±ÙŠ'},{id:'hi',n:'Ù‡Ù†Ø¯ÙŠ'},{id:'fr',n:'ÙØ±Ù†Ø³ÙŠ'},{id:'ja',n:'ÙŠØ§Ø¨Ø§Ù†ÙŠ'},{id:'es',n:'Ø¥Ø³Ø¨Ø§Ù†ÙŠ'},{id:'it',n:'Ø¥ÙŠØ·Ø§Ù„ÙŠ'},{id:'de',n:'Ø£Ù„Ù…Ø§Ù†ÙŠ'},{id:'ru',n:'Ø±ÙˆØ³ÙŠ'}];

    window.onpopstate = () => hidePages();
    function handleBack() { history.back(); }

    function switchMainTab(type) {
        currentMode = type; page = 1;
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.toggle('active', b.id === 'tab-'+type));
        document.getElementById('section-content').style.display = type === 'tv' ? 'none' : 'block';
        document.getElementById('section-tv').style.display = type === 'tv' ? 'block' : 'none';
        document.getElementById('hero-slider').style.display = (type === 'tv' || type === 'fav') ? 'none' : 'block';
        if(type === 'tv' && tvChannels.length === 0) fetchTV(); 
        else if(type !== 'tv' && type !== 'fav') { renderFilters(); fetchContent(); fetchHero(); }
    }

    async function fetchHero() {
        const type = currentMode === 'movies' ? 'movie' : 'tv';
        const res = await fetch(`https://api.themoviedb.org/3/${type}/popular?api_key=${API_KEY}&language=ar-SA`);
        const data = await res.json();
        const slider = document.getElementById('hero-slider');
        const items = data.results.slice(0, 5);
        slider.innerHTML = items.map((m, idx) => `
            <div class="hero-slide ${idx===0?'active':''}" style="background-image:url('${BG_IMG + m.backdrop_path}')" onclick='showDetailsByItem(${JSON.stringify(m).replace(/"/g, "&quot;")})'>
                <div class="hero-title">${m.title || m.name}</div>
            </div>
        `).join('');
        slideIdx = 0; startSlider();
    }

    function handleTouchStart(e) { touchStartX = e.changedTouches[0].screenX; }
    function handleTouchEnd(e) {
        let touchEndX = e.changedTouches[0].screenX;
        if (touchStartX - touchEndX > 50) nextSlide();
        if (touchEndX - touchStartX > 50) prevSlide();
    }
    function changeSlide(dir) {
        const slides = document.querySelectorAll('.hero-slide'); if(!slides.length) return;
        slides[slideIdx].classList.remove('active');
        slideIdx = (slideIdx + dir + slides.length) % slides.length;
        slides[slideIdx].classList.add('active');
    }
    function nextSlide() { changeSlide(1); }
    function prevSlide() { changeSlide(-1); }
    function startSlider() { clearInterval(window.sInt); window.sInt = setInterval(nextSlide, 5000); }

    async function fetchContent(isMore = false) {
        const grid = document.getElementById('main-grid');
        if(!isMore) { page = 1; grid.innerHTML = ''; }
        const type = currentMode === 'movies' ? 'movie' : 'tv';
        let url = `https://api.themoviedb.org/3/discover/${type}?api_key=${API_KEY}&language=ar-SA&sort_by=popularity.desc&page=${page}`;
        if(currentGenre) url += `&with_genres=${currentGenre}`;
        if(currentLang) url += `&with_original_language=${currentLang}`;
        if(searchQuery) url = `https://api.themoviedb.org/3/search/${type}?api_key=${API_KEY}&language=ar-SA&query=${encodeURIComponent(searchQuery)}&page=${page}`;
        const res = await fetch(url); const data = await res.json();
        data.results.forEach(i => { i.wika_type = currentMode; renderCard(i, grid); });
    }

    function renderCard(i, grid) {
        if(!i.poster_path && !i.logo) return;
        const isFav = favorites.some(f => f.id == i.id);
        const div = document.createElement('div'); div.className = 'movie-card';
        div.innerHTML = `
            <span class="badge">${i.vote_average ? i.vote_average.toFixed(1) : 'LIVE'}</span>
            <span class="fav-icon ${isFav?'active':''}" onclick="toggleFav(event, ${JSON.stringify(i).replace(/"/g, '&quot;')})">â¤</span>
            <img src="${i.poster_path ? IMG + i.poster_path : i.logo}" onclick='showDetailsByItem(${JSON.stringify(i).replace(/"/g, "&quot;")})'>
            <div class="movie-info">${i.title || i.name}</div>
        `;
        grid.appendChild(div);
    }

    function toggleFav(e, item) {
        e.stopPropagation();
        const idx = favorites.findIndex(f => f.id == item.id);
        if(idx > -1) favorites.splice(idx, 1); else favorites.push(item);
        localStorage.setItem('wika_favs', JSON.stringify(favorites));
        e.target.classList.toggle('active');
        if(currentMode === 'fav') showFavorites();
    }

    function showFavorites() {
        currentMode = 'fav';
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.toggle('active', b.id === 'tab-fav'));
        document.getElementById('section-content').style.display = 'block';
        document.getElementById('section-tv').style.display = 'none';
        document.getElementById('hero-slider').style.display = 'none';
        document.getElementById('filter-area').style.display = 'block';
        document.getElementById('genres-bar').innerHTML = `
            <button class="filter-btn ${favSubMode==='movies'?'active':''}" onclick="switchFavSub('movies')">Ø£ÙÙ„Ø§Ù… Ù…ÙØ¶Ù„Ø©</button>
            <button class="filter-btn ${favSubMode==='tvshows'?'active':''}" onclick="switchFavSub('tvshows')">Ù…Ø³Ù„Ø³Ù„Ø§Øª Ù…ÙØ¶Ù„Ø©</button>
            <button class="filter-btn ${favSubMode==='tv'?'active':''}" onclick="switchFavSub('tv')">Ù‚Ù†ÙˆØ§Øª Ù…ÙØ¶Ù„Ø©</button>
        `;
        document.getElementById('langs-bar').innerHTML = '';
        renderFavGrid();
        document.getElementById('load-more-btn').style.display = 'none';
    }

    function switchFavSub(mode) { favSubMode = mode; showFavorites(); }
    function renderFavGrid() {
        const grid = document.getElementById('main-grid'); grid.innerHTML = '';
        const filtered = favorites.filter(fav => fav.wika_type === favSubMode);
        if(filtered.length) filtered.forEach(i => renderCard(i, grid));
        else grid.innerHTML = '<p style="text-align:center; width:100%">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…ÙØ¶Ù„Ø§Øª.</p>';
    }

    async function showDetailsByItem(i) {
        document.getElementById('details-page').style.display = 'block';
        history.pushState({p: 'd'}, "", "#details");
        const type = i.title ? 'movie' : 'tv';
        const date = i.release_date || i.first_air_date || '----';
        document.getElementById('details-content').innerHTML = `
            <div style="text-align:center; padding:40px 20px;">
                <img src="${IMG + i.poster_path}" style="width:200px; border-radius:15px; box-shadow:0 10px 20px #000;">
                <h1 style="margin:20px 0 5px 0;">${i.title || i.name}</h1>
                <div class="meta-info">
                    <span>â­ ${i.vote_average || '0'}</span> | <span>ğŸ“… ${date.split('-')[0]}</span> | <span>ğŸ¬ ${type === 'movie' ? 'ÙÙŠÙ„Ù…' : 'Ù…Ø³Ù„Ø³Ù„'}</span>
                </div>
                <p class="description">${i.overview || 'Ù„Ø§ ÙŠÙˆØ¬Ø¯ ÙˆØµÙ Ù…ØªØ§Ø­.'}</p>
                <button class="btn-action" onclick="openPlayer('${i.id}', '${i.wika_type || (i.title?'movies':'tvshows')}', '${i.name || i.title}', '${i.url || ''}')">â–¶ Ù…Ø´Ø§Ù‡Ø¯Ø© Ø§Ù„Ø¢Ù†</button>
            </div>`;
    }

    async function openPlayer(id, type, name, url) {
        document.getElementById('player-page').style.display = 'block';
        const frame = document.getElementById('video-frame');
        const epArea = document.getElementById('episodes-area');
        history.pushState({p: 'p'}, "", "#player");

        if(type === 'tvshows') {
            epArea.style.display = 'block';
            document.getElementById('series-title').innerText = name;
            const res = await fetch(`https://api.themoviedb.org/3/tv/${id}?api_key=${API_KEY}&language=ar-SA`);
            const data = await res.json();
            document.getElementById('season-bar').innerHTML = data.seasons.filter(s=>s.season_number>0).map(s => `<button class="filter-btn" onclick="loadEpisodes('${id}', ${s.season_number})">Ø§Ù„Ù…ÙˆØ³Ù… ${s.season_number}</button>`).join('');
            loadEpisodes(id, 1);
        } else if(type === 'movies') {
            epArea.style.display = 'none';
            frame.innerHTML = `<iframe src="https://vidsrc.xyz/embed/movie?tmdb=${id}" allowfullscreen></iframe>`;
        } else {
            epArea.style.display = 'none';
            frame.innerHTML = `<video id="video" controls autoplay style="width:100%"></video>`;
            if (Hls.isSupported()) { const hls = new Hls(); hls.loadSource(url); hls.attachMedia(document.getElementById('video')); }
        }
    }

    async function loadEpisodes(tvId, sNum) {
        const res = await fetch(`https://api.themoviedb.org/3/tv/${tvId}/season/${sNum}?api_key=${API_KEY}&language=ar-SA`);
        const data = await res.json();
        document.getElementById('episode-bar').innerHTML = data.episodes.map(e => `<div class="ep-btn" onclick="playEp('${tvId}', ${sNum}, ${e.episode_number})">Ø­Ù„Ù‚Ø© ${e.episode_number}</div>`).join('');
    }

    function playEp(id, s, e) { document.getElementById('video-frame').innerHTML = `<iframe src="https://vidsrc.xyz/embed/tv?tmdb=${id}&season=${s}&episode=${e}" allowfullscreen></iframe>`; window.scrollTo(0,0); }

    async function fetchTV() {
        const res = await fetch('https://iptv-org.github.io/iptv/index.m3u');
        const data = await res.text();
        const lines = data.split('\n'); tvChannels = [];
        for (let i = 0; i < lines.length; i++) {
            if (lines[i].startsWith('#EXTINF')) {
                const url = lines[i+1]?.trim();
                const name = lines[i].split(',')[1]?.trim() || "Ù‚Ù†Ø§Ø©";
                const logo = lines[i].match(/tvg-logo="([^"]+)"/)?.[1] || "";
                const group = lines[i].match(/group-title="([^"]+)"/)?.[1] || "";
                if(url?.startsWith('http')) tvChannels.push({id: 'tv_'+i, name, url, logo, group, wika_type: 'tv'});
            }
        }
        filterTV('all');
    }

    function filterTV(f, b) {
        if(b) { document.querySelectorAll('#section-tv .filter-btn').forEach(btn => btn.classList.remove('active')); b.classList.add('active'); }
        const grid = document.getElementById('tv-grid'); grid.innerHTML = '';
        tvChannels.filter(c => f === 'all' || c.group.toLowerCase().includes(f.toLowerCase())).slice(0, 40).forEach(c => renderCard(c, grid));
    }

    function renderFilters() {
        document.getElementById('filter-area').style.display = 'block'; document.getElementById('load-more-btn').style.display = 'block';
        document.getElementById('genres-bar').innerHTML = genresList.map(g => `<button class="filter-btn ${currentGenre==g.id?'active':''}" onclick="updateFilter('genre','${g.id}')">${g.n}</button>`).join('');
        document.getElementById('langs-bar').innerHTML = langsList.map(l => `<button class="filter-btn ${currentLang==l.id?'active':''}" onclick="updateFilter('lang','${l.id}')">${l.n}</button>`).join('');
    }
    function updateFilter(t, v) { if(t === 'genre') currentGenre = v; else currentLang = v; fetchContent(); }
    function loadMore() { page++; fetchContent(true); }
        function hidePages() { 
        document.getElementById('details-page').style.display='none'; 
        document.getElementById('player-page').style.display='none'; 
        document.getElementById('video-frame').innerHTML=''; 
    }

    document.getElementById('search-input').oninput = (e) => { 
        searchQuery = e.target.value; 
        fetchContent(); 
    };

    async function fetchTV() {
        const res = await fetch('https://iptv-org.github.io/iptv/index.m3u');
        const data = await res.text();
        const lines = data.split('\n'); tvChannels = [];
        for (let i = 0; i < lines.length; i++) {
            if (lines[i].startsWith('#EXTINF')) {
                const url = lines[i+1]?.trim();
                const name = lines[i].split(',')[1]?.trim() || "Ù‚Ù†Ø§Ø©";
                const logo = lines[i].match(/tvg-logo="([^"]+)"/)?.[1] || "";
                const group = lines[i].match(/group-title="([^"]+)"/)?.[1] || "";
                if(url?.startsWith('http')) tvChannels.push({id: 'tv_'+i, name, url, logo, group, wika_type: 'tv'});
            }
        }
        filterTV('all');
    }

    function filterTV(f, b) {
        if(b) { document.querySelectorAll('#section-tv .filter-btn').forEach(btn => btn.classList.remove('active')); b.classList.add('active'); }
        const grid = document.getElementById('tv-grid'); grid.innerHTML = '';
        tvChannels.filter(c => f === 'all' || c.group.toLowerCase().includes(f.toLowerCase())).slice(0, 40).forEach(c => renderCard(c, grid));
    }

    switchMainTab('movies');

    // ÙƒÙˆØ¯ Ø§Ù„Ø±Ø¨Ø· Ø§Ù„Ø¬Ø¯ÙŠØ¯ Ù„Ø²Ø± Ø§Ù„ØªØ«Ø¨ÙŠØª ÙˆØ§Ù„Ù€ Service Worker Ù„Ø¶Ù…Ø§Ù† Ø§Ù„Ø¹Ù…Ù„ Ø¹Ù„Ù‰ Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø¬Ø¯ÙŠØ¯
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('/My-cinema-/sw.js')
        .then(() => console.log("Wika Cinema SW Registered"))
        .catch(err => console.log("SW Registration Failed:", err));
    }

    let deferredPrompt;
    const installBtn = document.getElementById('installBtn');

    window.addEventListener('beforeinstallprompt', (e) => {
      e.preventDefault();
      deferredPrompt = e;
      if (installBtn) installBtn.style.display = 'block';
    });

    if (installBtn) {
        installBtn.addEventListener('click', async () => {
          if (deferredPrompt) {
            deferredPrompt.prompt();
            const { outcome } = await deferredPrompt.userChoice;
            if (outcome === 'accepted') {
              console.log('User accepted installation');
              installBtn.style.display = 'none';
            }
            deferredPrompt = null;
          }
        });
    }
</script>
</body>
</html>
